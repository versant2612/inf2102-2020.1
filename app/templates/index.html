<!-- index.html-->
{% import "bootstrap/wtf.html" as wtf %}
{% extends "base.html" %}
{% block title %}Home{% endblock %}
{% block body %}

<div class="jumbotron">
    <div class="row">
        <div class="col-sm-4"><a href="http://www.puc-rio.br/"><img src="../static/images/puc-rio-logo.png" width="70" height="115" align="left"></div></a>
        <div class="col-sm-4"><a href="http://www.nima.puc-rio.br/"><img src="../static/images/logo-nima.png" width="250" height="100" align="middle"></div></a>
        <div class="col-sm-4"><a href="http://www.inf.puc-rio.br//"><img src="../static/images/lodoDI.png" width="180" height="95" align="right"></div></a>
    </div>
    <h1>Bem-vindo ao Sistema NIMA</h1>
    <p class="lead">Digite as palavras-chave que quer pesquisar: </p><br>
    {% if form %}
        <form role="form" method="POST" action="/">
            {{ form.hidden_tag() }}
            {{ wtf.form_errors(form, hiddens="only") }}
            <div class="form-group required" style="text-align:center">
                {{ form.busca(class_="form-control", style="width: 60%; display:inline; font-size:20px", placeholder="Por exemplo: meio ambiente ou ecologia")}}
                <button type="submit" class="btn btn-default" id="submit_id" style="margin-bottom:5px" onclick="waiting()">Pesquisar</button> 
            </div>

            <div id="loading" align="center" style="display:none">
                <p> Por favor, aguarde. Os dados demoram em geral 15 segundos para serem carregados.</p>
                <br>
                <img src="../static/images/loading.gif" alt="Carregando Gráficos">
            </div>
            
            {% if dados %}
            <p class="lead_2">Têm <b> {{nResultados}} </b> autores relacionados com a(s) palavra(s) <b> {{busca}} </b> : <p>

            <table class="dt-responsive table table-striped table-bordered" id="tabela">
                <thead>
                    <tr>
                        <th width="40%" class="th-sm" style="text-align:center; font-size: 20px">Nome</th>
                        <th width="20%" class="th-sm" style="text-align:center; font-size: 20px">Ocorrências</th>
                    </tr>
                </thead>
                <tbody>
                    {% for dado in dados: %}
                    <tr>
                        <td><a href="{{ url_for('about', pessoa=dado[0], busca=busca, nRepositorio=dado[1][1]) }}" style="font-size: 20px">{{ dado[0].upper() }}</a><br></td>
                        <td style="text-align:center; font-size: 20px" >{{ dado[1][0]|int }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            {% endif %} 
            </table>
        </form>
    {% endif %}
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>

<!-- LOADING --->
<script>

    function waiting(){
        document.getElementById("loading").style.display="block"; 
        $('#loading').fadeIn('slow');
    };

    $(document).ready(function(){
        $('#loading').fadeOut('slow');
    });

</script>


<script>
$(document).ready(function() {
    var table = $('#tabela').DataTable( {
      
      /*MUDA LINGUAGEM*/
        "language": {
            "lengthMenu": "Mostrar _MENU_ pessoas por página",
            "zeroRecords": "Não encontramos nada com esse filtro! :(",
            "info": "Mostrando _PAGE_ de _PAGES_",
            "infoEmpty": "Não há ocorrências com esse filtro",
            "infoFiltered": "(filtrado de um total de _MAX_ pessoas)",
          "paginate": {
        "first": "Primeiro",
        "last": "Último",
        "next": "Próximo",
        "previous": "Anterior",
      },
      "loadingRecords": "Carregando...",
      "search": "Filtrar:",
          "aria": {
        "sortAscending": ": Ative para ordenar a coluna de forma ascendente",
        "sortDescending": ": Ative para odenar a coluna de forma descendente"
      }
        },
        /*ORDENA POR ROLE POR DEFAULT*/
        "order": [[ 1, "desc" ]] 
    } );
} );
</script>

{% endblock %}


